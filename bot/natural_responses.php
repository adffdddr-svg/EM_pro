<?php
/**
 * Employee Management System
 * Ø±Ø¯ÙˆØ¯ Ø·Ø¨ÙŠØ¹ÙŠØ© ÙˆÙˆØ¯ÙŠØ© Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ©
 */

if (!defined('ACCESS_ALLOWED')) {
    define('ACCESS_ALLOWED', true);
}

require_once __DIR__ . '/conversation_manager.php';

/**
 * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ø¯ Ø·Ø¨ÙŠØ¹ÙŠ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
 */
function getNaturalResponse($message, $employee_id) {
    $message_lower = mb_strtolower(trim($message));
    $hour = (int)date('H');
    $day_of_week = date('N'); // 1-7
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù
    $employee = null;
    try {
        if (function_exists('getEmployeeInfoForBot')) {
            $employee = getEmployeeInfoForBot($employee_id);
        }
    } catch (Exception $e) {
        // ØªØ¬Ø§Ù‡Ù„
    }
    
    $name = 'Ø­Ø¨ÙŠØ¨ÙŠ';
    if ($employee) {
        $name = $employee['first_name'] ?? $employee['username'] ?? 'Ø­Ø¨ÙŠØ¨ÙŠ';
    }
    
    // Ù…Ø­Ø§ÙˆÙ„Ø© Small Talk Ø£ÙˆÙ„Ø§Ù‹
    if (function_exists('addSmallTalk')) {
        $small_talk = addSmallTalk($message, $employee_id);
        if ($small_talk !== null) {
            return $small_talk;
        }
    }
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±
    $recent_conversation = [];
    if (function_exists('getRecentConversation')) {
        $recent_conversation = getRecentConversation($employee_id, 2);
    }
    
    // Ø§Ù„ØªØ­ÙŠØ§Øª Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
    if (mb_strpos($message_lower, 'Ù…Ø±Ø­Ø¨Ø§') !== false || 
        mb_strpos($message_lower, 'Ø£Ù‡Ù„Ø§') !== false || 
        mb_strpos($message_lower, 'Ø³Ù„Ø§Ù…') !== false || 
        mb_strpos($message_lower, 'hello') !== false || 
        mb_strpos($message_lower, 'hi') !== false ||
        mb_strpos($message_lower, 'ØµØ¨Ø§Ø­') !== false ||
        mb_strpos($message_lower, 'Ù…Ø³Ø§Ø¡') !== false) {
        
        $greetings = [];
        if ($hour >= 5 && $hour < 12) {
            $greetings = [
                "ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ± {$name}! ðŸŒ… ÙƒÙŠÙÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ",
                "ØµØ¨Ø§Ø­ Ø§Ù„Ù†ÙˆØ± {$name}! â˜€ï¸ Ø´Ù„ÙˆÙ†ÙƒØŸ",
                "Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ {$name}! ØµØ¨Ø§Ø­Ùƒ Ø®ÙŠØ± ðŸŒŸ",
                "ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±! ÙƒÙŠÙ Ø§Ù„Ø­Ø§Ù„ Ø§Ù„ÙŠÙˆÙ…ØŸ ðŸ˜Š"
            ];
        } elseif ($hour >= 12 && $hour < 17) {
            $greetings = [
                "Ù…Ø±Ø­Ø¨Ø§Ù‹ {$name}! ðŸ‘‹ Ø´Ù„ÙˆÙ†ÙƒØŸ",
                "Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ {$name}! ÙƒÙŠÙÙƒØŸ",
                "Ù…Ø±Ø­Ø¨ØªÙŠÙ† {$name}! Ø´Ù„ÙˆÙ† Ø§Ù„Ø­Ø§Ù„ØŸ ðŸ˜Š",
                "Ø£Ù‡Ù„Ø§Ù‹ {$name}! ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø£Ø³Ø§Ø¹Ø¯ÙƒØŸ"
            ];
        } else {
            $greetings = [
                "Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ± {$name}! ðŸŒ™ ÙƒÙŠÙÙƒØŸ",
                "Ù…Ø³Ø§Ø¡ Ø§Ù„Ù†ÙˆØ± {$name}! ÙƒÙŠÙ Ø§Ù„Ø­Ø§Ù„ØŸ",
                "Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ {$name}! Ù…Ø³Ø§Ø¡Ùƒ Ø®ÙŠØ± ðŸŒŸ",
                "Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±! ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø£Ø³Ø§Ø¹Ø¯ÙƒØŸ ðŸ˜Š"
            ];
        }
        
        // ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø± - Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø§Ù„ Ù…Ø±Ø­Ø¨Ø§ Ù‚Ø¨Ù„ Ù‚Ù„ÙŠÙ„ØŒ Ø±Ø¯ Ù…Ø®ØªÙ„Ù
        $last_user_msg = !empty($recent_conversation) ? mb_strtolower($recent_conversation[count($recent_conversation)-1]['user_message'] ?? '') : '';
        
        if (mb_strpos($last_user_msg, 'Ù…Ø±Ø­Ø¨Ø§') !== false || mb_strpos($last_user_msg, 'Ø£Ù‡Ù„Ø§') !== false) {
            // Ø¥Ø°Ø§ Ù‚Ø§Ù„ Ù…Ø±Ø­Ø¨Ø§ Ù‚Ø¨Ù„ Ù‚Ù„ÙŠÙ„ØŒ Ø±Ø¯ Ø¨Ø¨Ø³Ø§Ø·Ø©
            $simple_greetings = [
                "Ø£Ù‡Ù„Ø§Ù‹ {$name}! Ø´Ù†Ùˆ ØªØ­ØªØ§Ø¬ØŸ",
                "Ù…Ø±Ø­Ø¨Ø§Ù‹ {$name}! Ø´Ù„ÙˆÙ† Ø£Ù‚Ø¯Ø± Ø£Ø³Ø§Ø¹Ø¯ÙƒØŸ",
                "Ø£Ù‡Ù„Ø§Ù‹! Ø´Ù†Ùˆ ØªØ±ÙŠØ¯ØŸ"
            ];
            return $simple_greetings[array_rand($simple_greetings)];
        }
        
        $greeting = $greetings[array_rand($greetings)];
        
        // Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø·Ø¨ÙŠØ¹ÙŠ Ù…ØªÙ†ÙˆØ¹
        $follow_ups = [
            "Ø´Ù„ÙˆÙ† Ø£Ù‚Ø¯Ø± Ø£Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„ÙŠÙˆÙ…ØŸ",
            "Ø´Ù†Ùˆ ØªØ­ØªØ§Ø¬ØŸ",
            "Ø´Ù†Ùˆ Ø£Ø®Ø¯Ù…ÙƒØŸ",
            "Ø´Ù†Ùˆ ØªØ±ÙŠØ¯ØŸ",
            "ÙƒÙŠÙ Ø£Ù‚Ø¯Ø± Ø£Ø³Ø§Ø¹Ø¯ÙƒØŸ",
            "Ø´Ù†Ùˆ ÙÙŠ Ø¨Ø§Ù„ÙƒØŸ"
        ];
        
        $response = $greeting . " " . $follow_ups[array_rand($follow_ups)];
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙƒØ±Ø§Ø±
        if (function_exists('isRepeatedResponse') && isRepeatedResponse($response, $employee_id)) {
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙƒØ±Ø±ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø±Ø¯ Ù…Ø®ØªÙ„Ù
            $alternative = "Ø£Ù‡Ù„Ø§Ù‹ {$name}! ðŸ‘‹\nØ´Ù„ÙˆÙ† Ø£Ù‚Ø¯Ø± Ø£Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„ÙŠÙˆÙ…ØŸ";
            return $alternative;
        }
        
        return $response;
    }
    
    // Ø§Ù„Ø±Ø§ØªØ¨ - Ø±Ø¯ÙˆØ¯ Ø·Ø¨ÙŠØ¹ÙŠØ©
    if (mb_strpos($message_lower, 'Ø±Ø§ØªØ¨') !== false || 
        mb_strpos($message_lower, 'Ù…Ø±ØªØ¨') !== false || 
        mb_strpos($message_lower, 'salary') !== false ||
        mb_strpos($message_lower, 'Ø´ÙƒØ¯') !== false && mb_strpos($message_lower, 'Ø±Ø§ØªØ¨') !== false) {
        
        try {
            if (function_exists('getSalaryInfo')) {
                $salary_info = getSalaryInfo($employee_id);
                if (!empty($salary_info) && mb_strpos($salary_info, 'Ù…Ø¯ÙŠØ±') === false) {
                    return $salary_info;
                }
            }
        } catch (Exception $e) {
            // ØªØ¬Ø§Ù‡Ù„
        }
        
        $responses = [
            "Ø­Ø¨ÙŠØ¨ÙŠ {$name}ØŒ Ø£Ù†Øª Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…. Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø§Ù„Ø±Ø§ØªØ¨ØŒ Ù„Ø§Ø²Ù… ØªØªÙˆØ§ØµÙ„ Ù…Ø¹ Ù‚Ø³Ù… Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©. ðŸ’¼",
            "{$name}ØŒ Ø£Ù†Øª Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… Ø­Ø§Ù„ÙŠØ§Ù‹. Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø§Ù„Ø±Ø§ØªØ¨ØŒ ØªÙˆØ§ØµÙ„ Ù…Ø¹ HR. ðŸ“ž",
            "Ø­Ø¨ÙŠØ¨ÙŠØŒ Ø£Ù†Øª Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…. Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø§Ù„Ø±Ø§ØªØ¨ØŒ Ø±Ø§Ø¬Ø¹ Ù‚Ø³Ù… Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©. ðŸ’¼"
        ];
        return $responses[array_rand($responses)];
    }
    
    // Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
    if (mb_strpos($message_lower, 'Ø¥Ø¬Ø§Ø²') !== false || 
        mb_strpos($message_lower, 'Ø¹Ø·Ù„Ø©') !== false || 
        mb_strpos($message_lower, 'leave') !== false ||
        mb_strpos($message_lower, 'Ø±Ø§Ø­Ø©') !== false) {
        
        try {
            if (function_exists('getLeaveInfo')) {
                $leave_info = getLeaveInfo($employee_id);
                if (!empty($leave_info)) {
                    return $leave_info;
                }
            }
        } catch (Exception $e) {
            // ØªØ¬Ø§Ù‡Ù„
        }
        
        $responses = [
            "Ø­Ø¨ÙŠØ¨ÙŠ {$name}ØŒ Ø­Ø§Ù„ÙŠØ§Ù‹ Ù…Ø§ Ø¹Ù†Ø¯ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª. ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ù‚Ø³Ù… Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© Ø¹Ø´Ø§Ù† ØªÙØ§ØµÙŠÙ„ Ø£ÙƒØ«Ø±. ðŸ“…",
            "{$name}ØŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹. Ø±Ø§Ø¬Ø¹ HR Ù„Ù„Ù…Ø²ÙŠØ¯. ðŸ“ž",
            "Ø­Ø¨ÙŠØ¨ÙŠØŒ Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§ØªØŒ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ù‚Ø³Ù… Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©. ðŸ“…"
        ];
        return $responses[array_rand($responses)];
    }
    
    // Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ©
    if (mb_strpos($message_lower, 'Ø­Ø§Ù„Ø©') !== false || 
        mb_strpos($message_lower, 'ÙˆØ¶Ø¹') !== false || 
        mb_strpos($message_lower, 'status') !== false ||
        mb_strpos($message_lower, 'Ø´Ù„ÙˆÙ†') !== false && mb_strpos($message_lower, 'Ø­Ø§Ù„ØªÙŠ') !== false) {
        
        try {
            if (function_exists('getEmployeeStatusInfo')) {
                $status_info = getEmployeeStatusInfo($employee_id);
                if (!empty($status_info)) {
                    return $status_info;
                }
            }
        } catch (Exception $e) {
            // ØªØ¬Ø§Ù‡Ù„
        }
        
        $responses = [
            "Ø­Ø¨ÙŠØ¨ÙŠ {$name}ØŒ Ø­Ø§Ù„ØªÙƒ Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ©: Ù†Ø´Ø· âœ…\nØ£Ù†Øª Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… Ø­Ø§Ù„ÙŠØ§Ù‹.",
            "{$name}ØŒ Ø£Ù†Øª Ù†Ø´Ø· ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… âœ…\nØ£Ù†Øª Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù….",
            "Ø­Ø§Ù„ØªÙƒ Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ© Ù…Ù…ØªØ§Ø²Ø© {$name}! âœ…\nØ£Ù†Øª Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…."
        ];
        return $responses[array_rand($responses)];
    }
    
    // Ø§Ù„Ù†ÙƒØª
    if (mb_strpos($message_lower, 'Ù†ÙƒØª') !== false || 
        mb_strpos($message_lower, 'Ø¶Ø­Ùƒ') !== false || 
        mb_strpos($message_lower, 'joke') !== false ||
        mb_strpos($message_lower, 'Ø·Ø±ÙØ©') !== false) {
        
        $jokes = [
            "Ù„Ù…Ø§Ø°Ø§ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ø¨Ø§Ø±Ø¯ØŸ Ù„Ø£Ù†Ù‡ Windows Ù…ÙØªÙˆØ­! ðŸ˜„",
            "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù…ÙØ¶Ù„ Ù„Ù„Ø·Ø¨ÙŠØ¨ØŸ Ø§Ù„Ø¯ÙˆØ§Ø¡! ðŸ’Š",
            "Ù„Ù…Ø§Ø°Ø§ Ù„Ø§ ÙŠÙ†Ø§Ù… Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬ØŸ Ù„Ø£Ù†Ù‡ ÙŠØ¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¨Ù‚! ðŸ›",
            "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø­ÙŠÙˆØ§Ù† Ø§Ù„Ù…ÙØ¶Ù„ Ù„Ù„Ù…Ø¨Ø±Ù…Ø¬ØŸ Ø§Ù„ÙƒÙ„Ø¨ (Dog) Ù„Ø£Ù†Ù‡ ØµØ¯ÙŠÙ‚ Ø§Ù„Ø¥Ù†Ø³Ø§Ù†! ðŸ•",
            "Ø´Ù†Ùˆ Ù‚Ø§Ù„ Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬ Ù„Ù„Ø¨Ù†ØªØŸ Ø£Ù†Ø§ Ø£Ø­Ø¨Ùƒ (I love you)! ðŸ’»",
            "Ù„Ù…Ø§Ø°Ø§ Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬ Ù„Ø§ ÙŠØ£ÙƒÙ„ Ø§Ù„Ø¨ÙŠØªØ²Ø§ØŸ Ù„Ø£Ù†Ù‡ ÙŠØ®Ø§Ù Ù…Ù† Ø§Ù„Ù€ bugs! ðŸ•",
            "Ø´Ù†Ùˆ Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬ ÙˆØ§Ù„Ø·Ø¨ÙŠØ¨ØŸ Ø§Ù„Ø·Ø¨ÙŠØ¨ ÙŠØ¹Ø§Ù„Ø¬ Ø§Ù„Ù†Ø§Ø³ØŒ ÙˆØ§Ù„Ù…Ø¨Ø±Ù…Ø¬ ÙŠØ¹Ø§Ù„Ø¬ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯! ðŸ‘¨â€ðŸ’»"
        ];
        
        $joke = $jokes[array_rand($jokes)];
        $follow_ups = [
            " ðŸ˜„",
            " ðŸ˜‚\nØ´Ù„ÙˆÙ†ØŸ Ø¶Ø­ÙƒØªØŸ",
            " ðŸ˜Š\nØ£ØªÙ…Ù†Ù‰ Ø¶Ø­ÙƒØª!",
            " ðŸ˜„\nØ£ØªÙ…Ù†Ù‰ ØªØ­Ø³Ù†Øª Ù†ÙØ³ÙŠØªÙƒ!"
        ];
        
        return $joke . $follow_ups[array_rand($follow_ups)];
    }
    
    // Ø§Ù„ØªØ­ÙÙŠØ²
    if (mb_strpos($message_lower, 'ØªØ­ÙÙŠØ²') !== false || 
        mb_strpos($message_lower, 'Ø´Ø¬Ø¹Ø©') !== false || 
        mb_strpos($message_lower, 'motivation') !== false ||
        mb_strpos($message_lower, 'ÙƒÙ„Ù…Ø©') !== false) {
        
        $motivations = [
            "ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ± {$name}! ÙŠÙˆÙ… Ø¬Ø¯ÙŠØ¯ ÙŠØ¹Ù†ÙŠ ÙØ±Øµ Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ù†Ø¬Ø§Ø­ ðŸŒŸ\nØ£Ù†Øª Ù‚ÙˆÙŠ ÙˆØªÙ‚Ø¯Ø± ØªÙˆØµÙ„ Ù„Ø£Ù‡Ø¯Ø§ÙÙƒ! ðŸ’ª",
            "{$name}ØŒ Ø£Ù†Øª ØªÙ‚ÙˆÙ… Ø¨Ø¹Ù…Ù„ Ø±Ø§Ø¦Ø¹! Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆÙ„Ø§ ØªØ³ØªØ³Ù„Ù… ðŸš€",
            "ØªØ°ÙƒØ± {$name}: ÙƒÙ„ Ø®Ø·ÙˆØ© ØµØºÙŠØ±Ø© ØªÙ‚Ø±Ø¨Ùƒ Ù…Ù† Ù‡Ø¯ÙÙƒ Ø§Ù„ÙƒØ¨ÙŠØ± ðŸŽ¯\nØ£Ù†Øª Ø£Ù‚ÙˆÙ‰ Ù…Ù…Ø§ ØªØªØ®ÙŠÙ„! ðŸ’ª",
            "{$name}ØŒ Ø§Ù„Ù†Ø¬Ø§Ø­ Ù„ÙŠØ³ Ù†Ù‡Ø§ÙŠØ© ÙˆØ§Ù„ÙØ´Ù„ Ù„ÙŠØ³ Ù‚Ø§ØªÙ„Ø§Ù‹. Ø§Ù„Ù…Ù‡Ù… Ù‡Ùˆ Ø§Ù„Ø´Ø¬Ø§Ø¹Ø© Ù„Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ðŸŒŸ",
            "Ø£Ù†Øª Ù…Ø¨Ø¯Ø¹ {$name}! Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ ÙŠØ¨Ø¯Ø£ Ù…Ù† Ø­ÙŠØ« ÙŠÙ†ØªÙ‡ÙŠ Ø§Ù„Ø¢Ø®Ø±ÙˆÙ† âœ¨\nØ§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹!",
            "{$name}ØŒ ÙƒÙ„ ÙŠÙˆÙ… Ù‡Ùˆ ÙØ±ØµØ© Ø¬Ø¯ÙŠØ¯Ø© Ù„ØªÙƒÙˆÙ† Ø£ÙØ¶Ù„ Ù…Ù† Ø£Ù…Ø³ ðŸŒ…\nØ£Ù†Øª ØªÙ‚Ø¯Ø±! ðŸ’ª"
        ];
        
        return $motivations[array_rand($motivations)];
    }
    
    // Ø§Ù„Ø´ÙƒØ±
    if (mb_strpos($message_lower, 'Ø´ÙƒØ±') !== false || 
        mb_strpos($message_lower, 'Ù…Ø´ÙƒÙˆØ±') !== false || 
        mb_strpos($message_lower, 'thanks') !== false ||
        mb_strpos($message_lower, 'Ù…ØªØ´ÙƒØ±') !== false) {
        
        $responses = [
            "Ø§Ù„Ø¹ÙÙˆ {$name}! ðŸ˜Š Ø£Ù†Ø§ Ù‡Ù†Ø§ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ. Ø´Ù†Ùˆ ØªØ­ØªØ§Ø¬ Ø¨Ø¹Ø¯ØŸ",
            "Ù…Ø§ Ø¹Ù„ÙŠÙ‡ {$name}! ðŸ˜Š Ø£Ù†Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ø¥Ø°Ø§ Ø§Ø­ØªØ¬Øª Ø£ÙŠ Ø´ÙŠØ¡.",
            "Ø§Ù„Ø¹ÙÙˆ Ø­Ø¨ÙŠØ¨ÙŠ! ðŸ˜Š Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø¯Ø§Ø¦Ù…Ø§Ù‹. Ù‡Ù„ ØªØ­ØªØ§Ø¬ Ø´ÙŠØ¡ Ø«Ø§Ù†ÙŠØŸ",
            "Ù…Ø§ Ø¹Ù„ÙŠÙ‡ {$name}! ðŸ˜Š Ø£Ù†Ø§ Ø³Ø¹ÙŠØ¯ Ø¥Ù†Ù†ÙŠ Ù‚Ø¯Ø±Øª Ø£Ø³Ø§Ø¹Ø¯Ùƒ. Ø´Ù†Ùˆ Ø¨Ø¹Ø¯ØŸ"
        ];
        return $responses[array_rand($responses)];
    }
    
    // Ø§Ù„ÙˆØ¯Ø§Ø¹
    if (mb_strpos($message_lower, 'ÙˆØ¯Ø§Ø¹') !== false || 
        mb_strpos($message_lower, 'Ù…Ø¹ Ø§Ù„Ø³Ù„Ø§Ù…Ø©') !== false || 
        mb_strpos($message_lower, 'Ø¨Ø§ÙŠ') !== false || 
        mb_strpos($message_lower, 'goodbye') !== false ||
        mb_strpos($message_lower, 'bye') !== false) {
        
        $responses = [
            "Ù…Ø¹ Ø§Ù„Ø³Ù„Ø§Ù…Ø© {$name}! ðŸ‘‹ Ø£ØªÙ…Ù†Ù‰ Ù„Ùƒ ÙŠÙˆÙ…Ø§Ù‹ Ø±Ø§Ø¦Ø¹Ø§Ù‹!",
            "Ø§Ù„Ù„Ù‡ Ù…Ø¹Ùƒ {$name}! ðŸ‘‹ Ø£ØªÙ…Ù†Ù‰ Ù„Ùƒ ÙŠÙˆÙ… Ø¬Ù…ÙŠÙ„!",
            "Ù…Ø¹ Ø§Ù„Ø³Ù„Ø§Ù…Ø© Ø­Ø¨ÙŠØ¨ÙŠ! ðŸ‘‹ Ø£ØªÙ…Ù†Ù‰ Ù„Ùƒ Ø§Ù„ØªÙˆÙÙŠÙ‚!",
            "Ø§Ù„Ù„Ù‡ ÙŠØ­ÙØ¸Ùƒ {$name}! ðŸ‘‹ Ø£ØªÙ…Ù†Ù‰ Ù„Ùƒ ÙƒÙ„ Ø§Ù„Ø®ÙŠØ±!"
        ];
        return $responses[array_rand($responses)];
    }
    
    // Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
    if (mb_strpos($message_lower, 'Ù…Ø³Ø§Ø¹Ø¯Ø©') !== false || 
        mb_strpos($message_lower, 'help') !== false || 
        mb_strpos($message_lower, 'Ù…Ø§Ø°Ø§') !== false ||
        mb_strpos($message_lower, 'Ø´Ù†Ùˆ') !== false && mb_strpos($message_lower, 'ØªÙ‚Ø¯Ø±') !== false) {
        
        $responses = [
            "Ù…Ø±Ø­Ø¨Ø§Ù‹ {$name}! ðŸ‘‹ Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ HR. ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø£Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ:\n\nðŸ’° Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø§Ù„Ø±Ø§ØªØ¨\nðŸ“… Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª\nâœ… Ù…Ø¹Ø±ÙØ© Ø­Ø§Ù„ØªÙƒ Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ©\nðŸ’ª Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ­ÙÙŠØ²ÙŠØ©\nðŸ˜„ Ø¥Ø®Ø¨Ø§Ø±Ùƒ Ø¨Ù†ÙƒØªØ©\n\nØ´Ù†Ùˆ ØªØ­ØªØ§Ø¬ØŸ",
            "Ø£Ù‡Ù„Ø§Ù‹ {$name}! ðŸ‘‹ Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ:\n\nâ€¢ Ø§Ù„Ø±Ø§ØªØ¨ ðŸ’°\nâ€¢ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª ðŸ“…\nâ€¢ Ø­Ø§Ù„ØªÙƒ Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ© âœ…\nâ€¢ Ø±Ø³Ø§Ù„Ø© ØªØ­ÙÙŠØ²ÙŠØ© ðŸ’ª\nâ€¢ Ù†ÙƒØªØ© ðŸ˜„\n\nØ´Ù†Ùˆ ØªØ±ÙŠØ¯ØŸ",
            "Ù…Ø±Ø­Ø¨Ø§Ù‹ {$name}! ðŸ‘‹ Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ HR. ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø£Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ:\n\nðŸ’° Ø§Ù„Ø±Ø§ØªØ¨\nðŸ“… Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª\nâœ… Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ©\nðŸ’ª Ø±Ø³Ø§Ù„Ø© ØªØ­ÙÙŠØ²ÙŠØ©\nðŸ˜„ Ù†ÙƒØªØ©\n\nØ£Ùˆ Ø¨Ø³ Ù‚Ù„ Ù…Ø±Ø­Ø¨Ø§Ù‹! ðŸ‘‹"
        ];
        return $responses[array_rand($responses)];
    }
    
    // Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø­Ø§Ù„
    if (mb_strpos($message_lower, 'Ø´Ù„ÙˆÙ†Ùƒ') !== false || 
        mb_strpos($message_lower, 'ÙƒÙŠÙÙƒ') !== false || 
        mb_strpos($message_lower, 'ÙƒÙŠÙ Ø­Ø§Ù„Ùƒ') !== false ||
        mb_strpos($message_lower, 'how are you') !== false) {
        
        $responses = [
            "Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ {$name}! Ø£Ù†Ø§ Ø¨Ø®ÙŠØ±ØŒ Ø´ÙƒØ±Ø§Ù‹ Ù„Ø³Ø¤Ø§Ù„Ùƒ! ðŸ˜Š\nØ´Ù„ÙˆÙ†Ùƒ Ø£Ù†ØªØŸ",
            "Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ Ø­Ø¨ÙŠØ¨ÙŠ! Ø£Ù†Ø§ Ø¨Ø®ÙŠØ±ØŒ Ø´ÙƒØ±Ø§Ù‹! ðŸ˜Š\nÙƒÙŠÙÙƒ Ø£Ù†ØªØŸ",
            "Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ {$name}! Ø£Ù†Ø§ Ø¨Ø®ÙŠØ±! ðŸ˜Š\nØ´Ù„ÙˆÙ† Ø§Ù„Ø­Ø§Ù„ Ø¹Ù†Ø¯ÙƒØŸ"
        ];
        return $responses[array_rand($responses)];
    }
    
    // Ø±Ø¯ÙˆØ¯ Ø¹Ø§Ù…Ø© Ø·Ø¨ÙŠØ¹ÙŠØ© - Ù…Ø¹ ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±
    $general_responses = [
        "Ø­Ø¨ÙŠØ¨ÙŠ {$name}ØŒ Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ HR. ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø£Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ:\n\nðŸ’° Ø§Ù„Ø±Ø§ØªØ¨ - Ø§ÙƒØªØ¨ \"Ø´ÙƒØ¯ Ø±Ø§ØªØ¨ÙŠØŸ\"\nðŸ“… Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª - Ø§ÙƒØªØ¨ \"ÙƒÙ… Ø¥Ø¬Ø§Ø²Ø© Ù…ØªØ¨Ù‚ÙŠØ©ØŸ\"\nâœ… Ø§Ù„Ø­Ø§Ù„Ø© - Ø§ÙƒØªØ¨ \"Ø´Ù„ÙˆÙ† Ø­Ø§Ù„ØªÙŠØŸ\"\nðŸ’ª ØªØ­ÙÙŠØ² - Ø§ÙƒØªØ¨ \"Ø´Ø¬Ø¹Ø©\"\nðŸ˜„ Ù†ÙƒØªØ© - Ø§ÙƒØªØ¨ \"Ù†ÙƒØªØ©\"\n\nØ´Ù†Ùˆ ØªØ­ØªØ§Ø¬ØŸ",
        "Ù…Ø±Ø­Ø¨Ø§Ù‹ {$name}! ðŸ‘‹\n\nØ£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ HR. ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø£Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ:\nâ€¢ Ø§Ù„Ø±Ø§ØªØ¨ ðŸ’°\nâ€¢ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª ðŸ“…\nâ€¢ Ø­Ø§Ù„ØªÙƒ Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ© âœ…\nâ€¢ Ø±Ø³Ø§Ù„Ø© ØªØ­ÙÙŠØ²ÙŠØ© ðŸ’ª\nâ€¢ Ù†ÙƒØªØ© ðŸ˜„\n\nØ´Ù†Ùˆ ØªØ±ÙŠØ¯ØŸ",
        "Ø£Ù‡Ù„Ø§Ù‹ {$name}! ðŸ‘‹\n\nØ£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ:\nðŸ’° Ø§Ù„Ø±Ø§ØªØ¨\nðŸ“… Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª\nâœ… Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ©\nðŸ’ª Ø±Ø³Ø§Ù„Ø© ØªØ­ÙÙŠØ²ÙŠØ©\nðŸ˜„ Ù†ÙƒØªØ©\n\nØ´Ù†Ùˆ ØªØ­ØªØ§Ø¬ØŸ",
        "Ø­Ø¨ÙŠØ¨ÙŠ {$name}! Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ HR ðŸ‘‹\n\nØ£Ù‚Ø¯Ø± Ø£Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ:\nâ€¢ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø§Ù„Ø±Ø§ØªØ¨ ðŸ’°\nâ€¢ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª ðŸ“…\nâ€¢ Ø­Ø§Ù„ØªÙƒ Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ© âœ…\nâ€¢ Ø±Ø³Ø§Ø¦Ù„ ØªØ­ÙÙŠØ²ÙŠØ© ðŸ’ª\nâ€¢ Ù†ÙƒØªØ© Ø®ÙÙŠÙØ© ðŸ˜„\n\nØ´Ù†Ùˆ ÙÙŠ Ø¨Ø§Ù„ÙƒØŸ",
        "Ù…Ø±Ø­Ø¨Ø§Ù‹ {$name}! Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ðŸ‘‹\n\nÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø£Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ:\nðŸ’° Ø§Ù„Ø±Ø§ØªØ¨\nðŸ“… Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª\nâœ… Ø§Ù„Ø­Ø§Ù„Ø©\nðŸ’ª ØªØ­ÙÙŠØ²\nðŸ˜„ Ù†ÙƒØªØ©\n\nØ´Ù†Ùˆ ØªØ­ØªØ§Ø¬ØŸ"
    ];
    
    $response = $general_responses[array_rand($general_responses)];
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙƒØ±Ø§Ø±
    if (function_exists('isRepeatedResponse') && isRepeatedResponse($response, $employee_id)) {
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙƒØ±Ø±ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø±Ø¯ Ù…Ø®ØªÙ„Ù ØªÙ…Ø§Ù…Ø§Ù‹
        $alternative_responses = [
            "Ø­Ø¨ÙŠØ¨ÙŠ {$name}ØŒ Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ HR. Ø´Ù†Ùˆ ØªØ­ØªØ§Ø¬ØŸ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø£Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ Ø§Ù„Ø±Ø§ØªØ¨ØŒ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§ØªØŒ Ø§Ù„Ø­Ø§Ù„Ø©ØŒ Ø£Ùˆ Ø­ØªÙ‰ Ù†ÙƒØªØ©! ðŸ˜Š",
            "Ø£Ù‡Ù„Ø§Ù‹ {$name}! Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ. Ø´Ù†Ùˆ ØªØ±ÙŠØ¯ØŸ ðŸ’¼",
            "Ù…Ø±Ø­Ø¨Ø§Ù‹ {$name}! Ø´Ù„ÙˆÙ† Ø£Ù‚Ø¯Ø± Ø£Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„ÙŠÙˆÙ…ØŸ ðŸ‘‹"
        ];
        $response = $alternative_responses[array_rand($alternative_responses)];
    }
    
    return $response;
}

